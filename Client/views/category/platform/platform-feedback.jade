.row
    .col-md-12
        .well.feedbackQueryDiv
            .inlineBlk
                label {{"USER_TYPE"|translate}}
                select.form-control(style='max-width:300px', ng-model="vm.playerFeedbackQuery.playerType")
                    option(value='Real Player (all)') {{'REAL_PLAYER_ALL' | translate}}
                    option(value='Real Player (Individual)') {{'REAL_PLAYER_INDIVIDUAL' | translate}}
                    option(value='Real Player (Under Partner)') {{'REAL_PLAYER_UNDER_PARTNER' | translate}}
                    option(value='Test Player') {{'TEST_PLAYER' | translate}}
            .inlineBlk
                label {{"Player Level" | translate}}
                select.form-control(ng-model='vm.playerFeedbackQuery.playerLevel')
                    option(value='all') {{'ALL' | translate}}
                    option(ng-repeat='(i,v) in vm.allPlayerLvl', value='{{v._id}}') {{v.name | translate}}
            .inlineBlk(style="width:200px;")
                label.control-label {{'CREDIBILITY' | translate}}
                select.form-control#selectCredibilityRemarkFeedback(multiple="multiple", style='min-width:100px;height:34px;', ng-options='remark._id as remark.name | translate for remark in vm.filterCredibilityRemarks', ng-model='vm.playerFeedbackQuery.credibilityRemarks')
            .inlineBlk(style="width:200px;")
                label.control-label {{'CREDIBILITY_FILTER' | translate}}
                select.form-control#selectCredibilityRemarkFeedbackFilter(multiple="multiple", style='min-width:100px;height:34px;', ng-options='remark._id as remark.name | translate for remark in vm.filterCredibilityRemarks', ng-model='vm.playerFeedbackQuery.credibilityRemarksFilter')
            .inlineBlk
                //上次登入（距今）
                label {{"LAST_ACCESS_TILL_NOW"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.lastAccess" style="width:105px;display:inline-block")
                        option(value='0-7') {{'0-7'}}{{'DAYS'|translate}}
                        option(value='8-14') {{'8-14'}}{{'DAYS'|translate}}
                        option(value='15-28') {{'15-28'}}{{'DAYS'|translate}}
                        option(value='29') {{'29'}}{{'DAYS_AND_ABOVE'|translate}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.lastAccessFormal" style="width:80px;display:inline-block" ng-show="vm.playerFeedbackQuery.lastAccess === 'range'")
                    div.text-center(style="width:15px;display:inline-block" ng-show="vm.playerFeedbackQuery.lastAccess === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.lastAccessLatter" style="width:80px;display:inline-block" ng-show="vm.playerFeedbackQuery.lastAccess === 'range'")
            .inlineBlk
                label.control-label {{'FILTER_FEEDBACK_TOPIC' | translate}}
                select.form-control#selectFeedbackTopicFilter(multiple="multiple", style='min-width:100px;height:34px;', ng-options='topic.key as topic.value for topic in vm.playerFeedbackTopic', ng-model='vm.playerFeedbackQuery.filterFeedbackTopic')
            .inlineBlk
                //过滤回访（天）
                label {{"FILTER_FEEDBACK_DAY"|translate}}
                div
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.filterFeedback" style="width:100px;display:inline-block")
            .inlineBlk
                label {{"DEPOSIT_COUNT"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.depositCountOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.depositCountFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.depositCountOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.depositCountLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.depositCountOperator === 'range'")
            .inlineBlk
                label {{"PLAYER_VALUE"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.playerValueOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.playerValueFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.playerValueOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.playerValueLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.playerValueOperator === 'range'")
            .inlineBlk
                label {{"TOTAL_CONSUMPTION_TIMES"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.consumptionTimesOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.consumptionTimesFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.consumptionTimesOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.consumptionTimesLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.consumptionTimesOperator === 'range'")
            .inlineBlk
                label {{"PLAYER_PROFIT_AMOUNT"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.bonusAmountOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.bonusAmountFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.bonusAmountOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.bonusAmountLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.bonusAmountOperator === 'range'")
            .inlineBlk
                label {{"BonusTime"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.withdrawTimesOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.withdrawTimesFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.withdrawTimesOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.withdrawTimesLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.withdrawTimesOperator === 'range'")
            .inlineBlk
                label {{"TOTAL_TOP_UP"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.topUpSumOperator" style="width:75px;display:inline-block")
                        option(value='>=') {{'>='}}
                        option(value='=') {{'='}}
                        option(value='<=') {{'<='}}
                        option(value='range') {{'range'|translate}}
                    div(style="width:8px;display:inline-block")
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.topUpSumFormal" style="width:80px;display:inline-block")
                    div.text-center(style="width:15px;display:inline-block" ng-if="vm.playerFeedbackQuery.topUpSumOperator === 'range'") -
                    input.form-control(type="number" ng-model="vm.playerFeedbackQuery.topUpSumLatter" style="width:80px;display:inline-block" ng-if="vm.playerFeedbackQuery.topUpSumOperator === 'range'")
            .inlineBlk(style="width:200px;")
                label {{"GAME_LOBBY"|translate}}
                select.form-control#selectGameProvider(multiple="multiple", style='min-width:100px;height:34px;', ng-options='provider._id as provider.name for provider in vm.allGameProviders', ng-model='vm.playerFeedbackQuery.gameProviderId')
            .inlineBlk
                label {{"SYSTEM_PLAYER" | translate}}
                select.form-control(ng-model='vm.playerFeedbackQuery.isNewSystem', style="width:100px;")
                    option(value='') {{'all'|translate}}
                    option(value='new') {{'NEW_SYSTEM'|translate}}
                    option(value='old') {{'OLD_SYSTEM'|translate}}
            .inlineBlk
                label.control-label {{'REGISTRATION_TIME_START' | translate}}
                #registerStartTimePicker.datetimepicker.form-control
                    input.input-append.playerDate(style='width:76%,border:0;', data-format="dd/MM/yyyy hh:mm:ss", type='text')
                    span.add-on
                        i.fa-calendar.fa(data-time-icon='fa fa-clock-o', data-date-icon='fa fa-calendar')
            .inlineBlk
                label.control-label {{'REGISTRATION_TIME_END' | translate}}
                #registerEndTimePicker.datetimepicker.form-control
                    input.input-append.playerDate(style='width:76%,border:0;', data-format="dd/MM/yyyy hh:mm:ss", type='text')
                    span.add-on
                        i.fa-calendar.fa(data-time-icon='fa fa-clock-o', data-date-icon='fa fa-calendar')
            .inlineBlk.sPickDepartment
                label {{"REGISTRATION_DEPARTMENT"|translate}}
                select.spicker.form-control(ng-model='vm.playerFeedbackQuery.departments', bsp, multiple, data-actions-box='true' ng-change="vm.setQueryRole(vm.playerFeedbackQuery)", ng-options='dp._id as dp.departmentName | translate for dp in vm.queryDepartments')
            .inlineBlk.sPickDepartment
                label {{"REGISTRATION_ROLE"|translate}}
                select.spicker.form-control(ng-model='vm.playerFeedbackQuery.roles', bsp, multiple, data-actions-box='true' ng-change="vm.setQueryAdmins(vm.playerFeedbackQuery)", ng-options='dp._id as dp.roleName | translate for dp in vm.queryRoles')
            .inlineBlk.sPickDepartment
                label {{"REGISTRATION_ADMIN"|translate}}
                select.spicker.form-control(ng-model='vm.playerFeedbackQuery.admins', bsp, multiple, data-actions-box='true', ng-options='dp._id as dp.adminName | translate for dp in vm.queryAdmins')
            .inlineBlk
                label {{"CALL_PERMISSION"|translate}}
                div
                    select.form-control(ng-model="vm.playerFeedbackQuery.callPermission" style="width:105px;display:inline-block")
                        option(value='false') {{'DISABLE'|translate}}
                        option(value='true') {{'CALLABLE'|translate}}
                        option(value='all') {{'ALL'|translate}}
            .inlineBlk
                button.btn.btn-primary(ng-if="checkViewPermission('Platform','Feedback','Read')",ng-click='vm.playerFeedbackSearchType="one";vm.submitPlayerFeedbackQuery(true, false);') {{"SEARCH_SINGLE" | translate}}
            .inlineBlk
                button.btn.btn-primary(ng-if="checkViewPermission('Platform','Feedback','Read')",ng-click='vm.playerFeedbackSearchType="many";vm.submitPlayerFeedbackQuery(true, false);') {{"SEARCH_LIST" | translate}}
            .inlineBlk
                button.btn.btn-warning(ng-if="checkViewPermission('Platform','Feedback','Export') && !vm.ctiData.hasOnGoingMission", ng-disabled='vm.showExportButton()', ng-click='vm.exportPlayerQuery()') {{"PLAYER_EXPORT_BATCH" | translate}}
            .inlineBlk
                button.btn.btn-primary(ng-if="checkViewPermission('Platform','Feedback','BulkCall') && vm.ctiData.hasOnGoingMission && !vm.showFinishCalloutMissionButton",ng-click='vm.toggleCallOutMissionStatus()') {{"Pause/Resume Mission" | translate}}
            .inlineBlk
                button.btn.btn-primary(ng-if="checkViewPermission('Platform','Feedback','BulkCall') && vm.ctiData.hasOnGoingMission && !vm.showFinishCalloutMissionButton",ng-click='vm.stopCallOutMission()') {{"Stop Mission" | translate}}
            .inlineBlk
                button.btn.btn-warning(ng-if="checkViewPermission('Platform','Feedback','BulkCall') && vm.ctiData.hasOnGoingMission && vm.showFinishCalloutMissionButton",ng-click='vm.initBulkAddPlayerFeedback()') {{"Failed Call Player Feedback" | translate}}
            .inlineBlk
                button.btn.btn-warning(ng-if="checkViewPermission('Platform','Feedback','BulkCall') && vm.ctiData.hasOnGoingMission && vm.showFinishCalloutMissionButton",ng-click='vm.initBulkSMSToFailPlayers()') {{"Failed Call Player SMS" | translate}}
            .inlineBlk
                button.btn.btn-success(ng-if="checkViewPermission('Platform','Feedback','BulkCall') && vm.ctiData.hasOnGoingMission && vm.showFinishCalloutMissionButton",ng-click='vm.endCallOutMission()') {{"Finish Mission" | translate}}
            span#platformFeedbackSpin.collapse
                i.fa.fa-spinner.fa-spin
            span.margin-left-5


.row.margin-top-bottom-small(ng-show='!vm.selectedPlatform')
    .text-center.text-danger
        label {{"NO_PLATFORM_MESSAGE" | translate}}
.col-md-12
    label.inlineBlk(ng-show='vm.feedbackPlayersPara.total!=null') {{"Search Result" | translate}} : {{vm.feedbackPlayersPara.total}}
    .inlineBlk
    label.inlineBlk(ng-show='vm.ctiData.hasOnGoingMission') {{vm.callOutMissionStatus}}
    label.inlineBlk(ng-show='vm.ctiData.hasOnGoingMission') {{vm.ctiData.adminName}} : {{vm.callOutMissionStatusText}}  /  {{"Completed" | translate}} : ({{vm.callOutMissionProgressText}})
    .inlineBlk
        .btn.btn-primary(ng-click="vm.selectedCallOutMission()" ng-if="checkViewPermission('Platform','Feedback','BulkCall') && !vm.ctiData.hasOnGoingMission") {{"SELECTED_CALL" | translate}}
    .inlineBlk
        .btn.btn-primary(ng-click="vm.createCallOutMission()" ng-if="checkViewPermission('Platform','Feedback','BulkCall') && !vm.ctiData.hasOnGoingMission") {{"BULK_CALL" | translate}}
    .pull-right
        a.fa.fa-refresh.margin-top-5(ng-click='vm.submitPlayerFeedbackQuery(null, true)')
            text.margin-right-5.pull-left {{"Refresh" | translate}}

.row.margin-top-bottom-small(ng-show='vm.selectedPlatform')
    .col-md-12
        table.common-table#playerFeedbackDataTable.display(style="min-width:100%;")
            thead
        #playerFeedbackTablePage(ng-show='vm.playerFeedbackSearchType=="many"')
.row.margin-top-bottom-small(ng-show='vm.selectedPlatform && vm.playerFeedbackSearchType=="one"')
    .col-md-12
        table.common-table#playerFeedbackDataTableExtended.display(style="min-width:100%;")

    .col-md-6
        .panel.panel-primary.margin-top-bottom-small(ng-if="checkViewPermission('Platform','Feedback','Create')",style='background-color: #e4e4e4')
            .panel-heading.panel-heading-sm
                .panel-title
                    .text-center {{"ADD_FEEDBACK" | translate}}
            .panel-body
                table(style='min-width:100%')
                    tbody
                        tr
                            td {{'FEEDBACK_RESULTS' | translate}}
                            td
                                select(ng-model='vm.addFeedback.result', required)
                                    option(ng-repeat='(i,v) in vm.allPlayerFeedbackResults', value='{{v.key}}') {{v.value}}
                                button.btn.btn-primary(style='margin-left:20px;', ng-click="vm.addPlayerFeedbackResultData={};vm.deletePlayerFeedbackResultData={};", ng-show="checkViewPermission('Player', 'Feedback','ModifyFeedbackResult')", data-toggle="modal", data-target="#modalAddPlayerFeedbackResult") {{"ADD" | translate}}
                        tr
                            td {{'FEEDBACK_TOPIC' | translate}}
                            td
                                select(ng-model='vm.addFeedback.topic', required)
                                    option(ng-repeat='(i,v) in vm.playerFeedbackTopic', value='{{v.key}}') {{v.value}}
                                button.btn.btn-primary(style='margin-left:20px;', ng-click="vm.addPlayerFeedbackTopicData={};vm.deletePlayerFeedbackTopicData={};", ng-show="checkViewPermission('Player', 'Feedback','ModifyFeedbackTopic')", data-toggle="modal", data-target="#modalAddPlayerFeedbackTopic") {{"ADD" | translate}}
                        tr
                            td
                                text {{"REMARK" | translate}}
                            td.textareaDetail
                                textarea.form-control(type="textarea", rows='4', ng-model='vm.addFeedback.content')
                        tr
                            td(colspan=2)
                                .text-center
                                    button.btn.btn-danger.margin-right-5(ng-click='vm.addFeedback.content="";vm.addFeedback.result="";vm.addFeedback.topic="";') {{'Reset' | translate}}
                                    button.btn.btn-success(ng-disabled="!vm.addFeedback.result || !vm.addFeedback.topic || !vm.addFeedback.content", ng-click='vm.addPlayerFeedback(vm.addFeedback)') {{'CONFIRM' | translate}}
        .clearfix
        .panel.panel-primary.margin-top-bottom-small
            .panel-heading
                .text-center {{"CREDIBILITY_RECORD" | translate}}
            .panel-body
                table.simple-table
                    thead
                        tr
                            th {{"OPERATOR_NAME" | translate}}
                            th {{"TIME" | translate}}
                            th {{"CREDIBILITY" | translate}}
                            th {{"remark" | translate}}
                    tbody
                        tr(ng-repeat='(i, data) in vm.playerCredibilityComment')
                            td(style= "border: 1px solid #0099CC")
                                text {{data.admin}}
                            td(style= "border: 1px solid #0099CC")
                                text {{data.createTime}}
                            td(style="text-align:center;border: 1px solid #0099CC")
                                text {{data.remarks$}}
                            td(style = "background-color:white;border: 1px solid #0099CC")
                                text {{data.comment}}

    .col-md-6
        #playerAllFeedbackPanel.panel.panel-primary.margin-top-bottom-small
            .panel-heading(style='padding: 10px 0px;')
                .text-center
                    label {{"Feedback History" | translate}} : {{vm.curPlayerFeedbackDetail.length}}
                hr.margin-top-bottom-small(style='margin:4px;')
                .displayTable
                    .colGrid(style='width:160px') {{"TIME" | translate}}
                    .colGrid(style='width:100px') {{"ADMIN" | translate}}
                    .colGrid(style='width:120px') {{"RESULT" | translate}}
                    .colGrid(style='width:130px') {{"FEEDBACK_TOPIC" | translate}}
                    .colGrid(style='width:calc(75% - 300px)') {{"REMARK" | translate}}
            .panel-body(style='height: 300px;')
                .displayTable(ng-repeat='(i,v) in vm.curPlayerFeedbackDetail', ng-show='vm.curPlayerFeedbackDetail.length>0')
                    .colGrid(style='width:160px') {{vm.dateReformat(v.createTime)}}
                    .colGrid(style='width:100px') {{v.adminId.adminName || 'Unknown' | translate}}
                    .colGrid(style='width:120px') {{v.result$}}
                    .colGrid(style='width:130px') {{v.topic | translate}}
                    .colGrid(style='width:calc(75% - 300px)') {{v.content}}

.row(ng-show='vm.selectedPlatform&&vm.playerFeedbackSearchType=="one"')
    .col-md-12
        .pull-left
            button.btn.btn-primary(ng-click='vm.callPlayer(vm.curFeedbackPlayer)') {{"CallPlayer" | translate}}
        .pull-right.child-margin-5
            button.btn.btn-primary(ng-click='vm.getFeedbackPlayer("-")') {{"Page_Previous" | translate}} 1 {{"Player" | translate}}
            .inlineBlk
                label.form-control {{"Current Page" | translate}} {{vm.feedbackPlayersPara.index}}/{{vm.feedbackPlayersPara.total}}
            button.btn.btn-primary(ng-click='vm.getFeedbackPlayer("+")') {{"Page_Next" | translate}} 1 {{"Player" | translate}}
            .inlineBlk
                label {{'Jump to' | translate}}
            .inlineBlk
                input.form-control(style='width: 80px', type='number', ng-model='vm.feedbackPlayersPara.index', ng-change='vm.getFeedbackPlayer(vm.feedbackPlayersPara.index)')
            .inlineBlk
                label {{'Page' | translate}}

.row(ng-show='vm.selectedPlatform')
    .col-md-12
        .pull-left
            button.btn.btn-danger.btn-xs(ng-click='vm.forceStopFPMSCallOutMissions()') {{"Force Stop Mission" | translate}}

#modalExportSetting.modal.fade(tabindex='-1', role='dialog', data-backdrop='static', keyboard=false,aria-labelledby='myModalLabel', aria-hidden='true')
    .modal-dialog
        .modal-content
            .modal-header
                a.fa.fa-times.close(type='button', data-dismiss='modal')
                h4.modal-title {{"PLAYER_EXPORT_SETTING" | translate}}
            .modal-body
                form(name="form_player_export")
                    .panel.panel-primary
                        .panel-body
                            .well
                                .row
                                    .form-group.col-md-6
                                        label {{'BANNER TITLE' | translate}}
                                        input.form-control(type='text', ng-model='vm.exportPlayerSetting.title', required)
                                    .form-group.col-md-6
                                        label {{'TARGET_EXPORT_WEBSITE' | translate}}
                                        select.form-control(ng-model='vm.exportPlayerSetting.platform', required)
                                            option(ng-repeat='(i,v) in vm.allPlatformData', value='{{v}}') {{v.name}}
                                    .form-group.col-md-6
                                        label {{'PROPOSAL_EXPIRATION_MINUTE' | translate}}
                                        input.form-control(type='Number', ng-model='vm.exportPlayerSetting.expirationMins', required)
            .modal-footer
                //button.btn.btn-primary.common-button(ng-if='form_new_partner.$invalid', disabled='true') {{"CREATE" | translate}}
                button.btn.btn-primary.common-button(data-dismiss='modal', ng-disabled="form_player_export.$invalid", ng-click="vm.createExportPlayerProposal();") {{"Export" | translate}}
                button.btn.btn-warning.common-button(data-dismiss='modal') {{"CANCEL" | translate}}
