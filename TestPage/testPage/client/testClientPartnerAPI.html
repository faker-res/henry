<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    <title>Test partner Account</title>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>-->
    <!--<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>-->
    <!--<script src="common/require.js" data-main="testClientpartnerAPI"></script>-->
</head>
<h3>TEST PARTNER REGISTRATION (注册)</h3>

<!--For Testing Player Registration API (1)-->
<div class="test-container">
    <div>
        <label>Partner name
            <input type=text name="name">
        </label>
    </div>
    <div>
        <label id="realName">Real name
            <input type=text name="realName">
        </label>
    </div>
    <div>
        <label id="playerPassword">Password
            <input type=text name="password">
        </label>
    </div>
    <div>
        <label id="platformId">Platform Id
            <input type=text name="platformId">
        </label>
    </div>
    <div>
        <label id="playerPhone">Telephone
            <input type=text name="phoneNumber">
        </label>
    </div>
    <div>
        <label id="parent">Parent partner name
            <input type=text name="parent">
        </label>
    </div>
    <div>
        <button id="getRegCaptcha">Get Captcha Code</button>
        <img id="partnerRegCaptchaImg"/>
    </div>
    <p></p>
    <div>
        <label>Captcha Code
            <input type=text name="captcha">
        </label>
    </div>

    <div>
        <button data-api-name="register">Register</button>
    </div>
    <textarea id="playerRegConsole"></textarea>
</div>

<h3>TEST VALID USERNAME (用户是否有效)</h3>
<div class="test-container">
    <label>Platform Id
        <input type=text name="platformId">
    </label>
    <div></div>
    <label id="playerName1">Username
        <input id="playerName1Input" type=text name="name">
    </label>
    <p>

    <div>
        <button id="isValidUsername" data-api-name="isValidUsername">Is Username Valid</button>
    </div>
    <div>
        <textarea id="isValidUsernameConsole"></textarea>
    </div>
</div>

<h3>TEST partner LOGIN (登录)</h3>

<div class="test-container">
    <div>
        <label>Platform Id
            <input name="platformId" type=text>
        </label>
    </div>
    <label id="partnerNameLogin">Username
        <input id="partnerNameLoginInput" type=text name="name">
    </label>
    <div>
        <label id="partnerLoginPassword">Password
            <input id="partnerLoginPasswordInput" type=text name="password">
        </label>
    </div>
    <div>
        <label id="partnerLoginClientDomain">Client Domain
            <input id="partnerLoginClientDomainInput" type=text name="clientDomain">
        </label>
    </div>
    <div class="partnerCaptcha" style="display:block">
        <button id="getLoginCaptcha">Get Captcha Code</button>
        <img id="partnerLoginCaptchaImg"/>
    </div>
    <div class="partnerCaptcha" style="display:block">
        <label id="captchaCode">Captcha Code
            <input id="captchaCodeInput" type=text name="captcha">
        </label>
    </div>
    <p>
    <div>
        <!--For testing partner Login API (3)-->
        <button id="partnerLogin" data-api-name="login">Login</button>
    </div>
    <div>
        <textarea id="partnerLoginConsole"></textarea>
    </div>
</div>

<h3>TEST PARTNER LOGOUT (注销)</h3>
<div class="test-container">
    <!--For testing partner logout API (5)-->
    <div>
        <label>Partner ID
            <input type=text name="partnerId">
        </label>
    </div>
    <div>
        <button id="playerLogoutSuccess" data-api-name="logout">Logout</button>
    </div>
    <div>
        <textarea id="playerLogoutOutput"></textarea>
    </div>
</div>

<h3>Verify the authentication by token when Connection Lost after login (链接验证) </h3>
<div class='test-container'>
    <!--For testing Get player information API (7)-->
    <div>
        <label>Partner Id
            <input name="partnerId" type=text>
        </label>
    </div>
    <div>
        <label>Token
            <input name="token" type=text>
        </label>
    </div>
    <div>
        <button data-api-name="authenticate">Authenticate Token</button>
    </div>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>GET PARTNER INFORMATION(获取代理基本信息)</h3>
<div class='test-container'>
    <div>
        <button data-api-name="get">Get Information</button>
    </div>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>MODIFY PARTNER PASSWORD INFORMATION (修改登录密码)</h3>
<div class="test-container">
    <div>
        <label>Partner ID
            <input name="partnerId" type=text>
        </label>
    </div>
    <div>
        <label>Old Password
            <input id="playerOldPasswordInput" name="oldPassword" type=text>
        </label>
    </div>

    <div>
        <label id="playerNewPassword">New Password
            <input id="playerNewPasswordInput" name="newPassword" type=text>
        </label>
    </div>
    <p>
    <div>
        <!--For testing Modify the player login password API (9)-->
        <button id="modifyPassword" data-api-name="updatePassword">Update</button>
        <div>
            <textarea id="modifyPasswordOutput">Show Output</textarea>
        </div>
    </div>
</div>

<h3>MODIFY PARTNER BANK INFORMATION (修改银行信息)</h3>

<div class="test-container">
    <div>
        <label id="partnerId" name="partnerId">Partner Id
            <input id="partnerIDInput" name="partnerId" type=text>
        </label>
    </div>
    <div>
        <label id="bankName">Bank Name
            <input id="bankNameInput" type=text name="bankName">
        </label>
    </div>
    <div>
        <label id="bankAccount">Bank Account
            <input id="bankAccountInput" type=text name="bankAccount">
        </label>
    </div>
    <div>
        <label id="bankAccountName">Account Name
            <input id="accountNameInput" type=text name="bankAccountName">
        </label>
    </div>
    <div>
        <label id="bankAccountType">Account Type
            <input id="accountTypeInput" type=text name="bankAccountType">
        </label>
    </div>
    <div>
        <label id="bankAccountCity">Account City
            <input id="accountCityInput" type=text name="bankAccountCity">
        </label>
    </div>
    <div>
        <label id="bankBranch">Bank Branch
            <input id="bankBranchInput" type=text name="bankBranch">
        </label>
    </div>
    <div>
        <label id="bankAddress">Bank Address
            <input id="bankAddressInput" type=text name="bankAddress">
        </label>
    </div>
    <p></p>

    <div>
        <!--For testing Modify the player payment information API (8)-->
        <button id="ModifyPlayerPayment" data-api-name="fillBankInformation">Update</button>
        <div>
            <textarea id="ModifyPlayerPaymentOutput"></textarea>
        </div>
    </div>
</div>

<h3>UPDATE PARTNER PHONE NUMBER WITH SMS (通过短信验证码修改代理手机号码)</h3>

<div class="test-container">
    <div>
        <label>Platform Id
            <input name="platformId" type=text>
        </label>
    </div>
    <div>
        <label>PartnerId Id
            <input name="partnerId" type=text>
        </label>
    </div>
    <div>
        <label>Old Number
            <input type=number name="phoneNumber">
        </label>
    </div>
    <div>
        <label>New Number
            <input type=number name="newPhoneNumber">
        </label>
    </div>
    <button data-api-name="getSMSCode">Get Verification Code</button>
    <label>SMSCode
        <input type=text name="smsCode">
    </label>

    <div>
        <button data-api-name="updatePhoneNumberWithSMS">Update</button>
        <div>
            <textarea></textarea>
        </div>
    </div>
</div>

<h3>TEST getStatistics(获取代理统计信息)</h3>
<div class="test-container">
    <!--
    <div>
        <label name="partnerId">Partner Id
            <input name="partnerId" type=text>
        </label>
    </div>
    -->
    <div>
        <label>Query type (use "day/week/month")
            <input name="queryType">
        </label>
    </div>
    <button id="getStatistics" data-api-name="getStatistics">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner player list(获取玩家列表)</h3>
<div class="test-container">
    <div>
        <label id="partnerId1" name="partnerId">Partner Id
            <input id="partnerIDInput1" name="partnerId" type=text>
        </label>
    </div>
    <div>
        <label>Query type
            <input name="queryType">
        </label>
    </div>
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <div>
        <label>
            Available types:registerTime/lastLoginTime
        </label>
    </div>
    <button id="getPlayerSimpleList" data-api-name="getPlayerSimpleList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Domain List (获取域名列表)</h3>
<div class="test-container">
    <div>
    </div>
    <p></p>
    <button data-api-name="getDomainList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Bind partner player(绑定代理玩家)</h3>
<div class="test-container">
    <div>
        <label name="playerName">Player name
            <input name="playerName" type=text>
        </label>
    </div>

    <p>
        <button id="bindPartnerPlayer" data-api-name="bindPartnerPlayer">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>APPLY BONUS  (申请兑奖)</h3>
<div class="test-container">
    <div>
        <label>Bonus ID
            <input name="bonusId">
        </label>
    </div>
    <div>
        <label>Amount
            <input name="amount">
        </label>
    </div>
    <div>
        <label>honoreeDetail
            <input name="honoreeDetail">
        </label>
    </div>
    <p></p>
    <button data-api-name="applyBonus">Apply</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Bonus Request List (获取申请兑奖列表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Proposal Status
            <input name="status">
        </label>(Success/Pending/Fail)
    </div>
    <p></p>
    <button data-api-name="getBonusRequestList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Cancel Bonus Request (取消申请兑奖)</h3>
<div class="test-container">
    <div>
        <label>Proposal ID
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="cancelBonusRequest">Cancel</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner children report(获取下线报表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <button id="getPartnerChildrenReport" data-api-name="getPartnerChildrenReport">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner player payment report(获取下线玩家支付报表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <button id="getPartnerPlayerPaymentReport" data-api-name="getPartnerPlayerPaymentReport">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner player registration report (获取下线玩家来源报表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Domain
            <input name="domain" type="text">
        </label>
    </div>
    <div>
        <label>Player Name
            <input name="playerName" type="text">
        </label>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>
    </div>
    <button id="getPartnerPlayerRegistrationReport" data-api-name="getPartnerPlayerRegistrationReport">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner player commission info (获取佣金报表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime">
        </label>
    </div>
    <div>
        <label>End Time
            <input name="endTime">
        </label>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>
    </div>
    <button id="getPartnerCommission" data-api-name="getPartnerCommission">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner player registration stats (获取开户报表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime">
        </label>
    </div>
    <div>
        <label>End Time
            <input name="endTime">
        </label>
    </div>
    <button id="getPartnerPlayerRegistrationStats" data-api-name="getPartnerPlayerRegistrationStats">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Get partner commission value (获取佣金报表)</h3>
<div class="test-container">
    <button id="getPartnerCommissionValue" data-api-name="getPartnerCommissionValue">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<script>
    require(['services/client/ClientServices', 'common/WebSocketClient', 'common/TestHelper', 'testAPI/clientAPITest/ClientPartnerAPITest', 'testAPI/clientAPITest/ClientConnectionAPITest'],
        function (ClientServices, WebSocketClient, TestHelper, ClientPartnerAPITest, ClientConnectionAPITest) {
            var Client = function (url) {

                WebSocketClient.call(this, url);

                var partnerService = new ClientServices.PartnerService();
                this.addService(partnerService);

                var conService = new ClientServices.ConnectionService();
                this.addService(conService);
            };

            var proto = Client.prototype = Object.create(WebSocketClient.prototype);
            proto.constructor = Client;

            $(document).ready(function () {
                var client = new Client(TestHelper.websocketURL);
                client.connect();

                client.addEventListener("open", function () {
                    var partnerService = client.getService("partner");
                    var clientPartnerAPITest = new ClientPartnerAPITest(partnerService);

                    var connectionService = client.getService("connection");
                    var connAPITest = new ClientConnectionAPITest(connectionService);

                    connAPITest.setLang(function (data) {
                        console.log('setlang data.....', data);
                    });

                    function _arrayBufferToBase64(buffer) {
                        var binary = '';
                        var bytes = new Uint8Array(buffer);
                        var len = bytes.byteLength;
                        for (var i = 0; i < len; i++) {
                            binary += String.fromCharCode(bytes[i]);
                        }
                        return window.btoa(binary);
                    }

                    $("#getLoginCaptcha").click(function () {
                        clientPartnerAPITest.captcha(function (data) {
                            $("#partnerLoginCaptchaImg").attr("src", "data:image/png;base64," + _arrayBufferToBase64(data.data.data));
                        });
                    });

                    $("#getRegCaptcha").click(function () {
                        clientPartnerAPITest.captcha(function (data) {
                            $("#partnerRegCaptchaImg").attr("src", "data:image/png;base64," + _arrayBufferToBase64(data.data.data));
                        });
                    });

                    //todo::update function here
                    //TestHelper.loginCookiepartner(client, ClientpartnerAPITest);

                    TestHelper.setAPIName('ClientServices.partner');
                    TestHelper.attachListeners(clientPartnerAPITest);

                });

                TestHelper.addReconnectOnCloseListener(client);
            });
        }
    );
</script>
</body>
</html>
