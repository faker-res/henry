<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>TEST PAYMENT</title>
</head>
<body>
<h3>APPLY BONUS  (申请兑奖)</h3>
<div class="test-container">
    <div>
        <label>Bonus ID
            <input name="bonusId">
        </label>
    </div>
    <div>
        <label>Amount
            <input name="amount" type="number">
        </label>
    </div>
    <div>
        <label>honoreeDetail
            <input name="honoreeDetail">
        </label>
    </div>
    <p></p>
    <button data-api-name="applyBonus">Apply</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Bonus Request List (获取申请兑奖列表)</h3>
<div class="test-container">
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Proposal Status
            <input name="status">
        </label>
    </div>
    <p></p>
    <button data-api-name="getBonusRequestList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Cancel Bonus Request (取消申请兑奖)</h3>
<div class="test-container">
    <div>
        <label>Proposal ID
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="cancelBonusRequest">Cancel</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Bonus List  (获取奖品列表)</h3>
<div class="test-container">
    <button data-api-name="getBonusList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>OnlineTopUpType  (获取在线充值类型)</h3>
<div class="test-container">
    <div>
        <label>Merchant Use
            <input name="merchantUse">
        </label>
    </div>
    <p></p>
    <div>
        <label>Client Type
            <input name="clientType">
        </label>
    </div>
    <p></p>
    <button data-api-name="getOnlineTopupType">Get Online TopUp Type</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Create Online TopUp (在线充值)</h3>
<div class="test-container">
    <!--<div>-->
    <!--<label>*Player topup intention _id-->
    <!--<input name="_id">-->
    <!--</label>-->
    <!--</div>-->
    <div>
        <label>*topupType
            <input name="topupType">
        </label>
    </div>
    <div>
        <label>*amount
            <input name="amount" type="number">
        </label>
    </div>
    <div>
        <label>merchant use type
            <input name="merchantUseType" type="number">
        </label>
    </div>
    <div>
        <label>client type
            <input name="clientType" type="number">
        </label>
    </div>
    <p>
        <button id="topUpIntent" data-api-name="createOnlineTopupProposal">create Topup Proposal</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Add Manual Topup Request (手工充值)</h3>
<div class="test-container">
    <div>
        <label>Amount
            <input name="amount">
        </label>
    </div>
    <div>
        <label>lastBankcardNo
            <input name="lastBankcardNo">
        </label>
        <p>
    </div>
    <div>
        <label>bankTypeId
            <input name="bankTypeId">
        </label>
        <p>
    </div>
    <div>
        <label>depositMethod
            <input name="depositMethod">
        </label>
        <p>
    </div>
    <div>
        <label>provinceId
            <input name="provinceId">
        </label>
        <p>
    </div>
    <div>
        <label>cityId
            <input name="cityId">
        </label>
        <p>
    </div>
    <div>
        <label>districtId
            <input name="districtId">
        </label>
        <p>
    </div>
        <button data-api-name="requestManualTopup">Create</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Cancel Manual TopUp Request(取消手工充值)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="cancelManualTopupRequest">Cancel</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Delay Manual TopUp Request(延迟手工充值)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <div>
        <label>delayTime
            <input name="delayTime">
        </label>
    </div>
    <button data-api-name="delayManualTopupRequest">Delay</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Modify Manual TopUp Request(更改手工充值)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <div>
        <label>Bank Type Id
            <input name="bankTypeId">
        </label>
    </div>
    <p></p>
    <div>
        <label>Last Bank Card No
            <input name="lastBankcardNo">
        </label>
    </div>
    <p></p>
    <div>
        <label>Amount
            <input name="amount">
        </label>
    </div>
    <p></p>
    <div>
        <label>Province Id
            <input name="provinceId">
        </label>
    </div>
    <p></p>
    <div>
        <label>City Id
            <input name="cityId">
        </label>
    </div>
    <p></p>
    <div>
        <label>District Id
            <input name="districtId">
        </label>
    </div>
    <p></p>
    <button data-api-name="modifyManualTopupRequest">Modify</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Manual TopUp Request List(获取手工充值申请列表)</h3>
<div class="test-container">
    <div>
        <label>Request Id
            <input name="requestId">
        </label>
    </div>
    <p></p>
    <button data-api-name="getManualTopupRequestList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Manual TopUp status Notify(手工充值状态通知)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <div>
        <label>Handle Time
            <input name="handleTime" type="datetime-local">
        </label>
    </div>
    <p></p>
    <div>
        <label>Status
            <input name="status">
        </label>
    </div>
    <p></p>
    <div>
        <label>Content
            <input name="content">
        </label>
    </div>
    <p></p>
    <button data-api-name="manualTopupStatusNotify">Notify</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Online topup status notify(在线充值状态通知)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <div>
        <label>Handle Time
            <input name="handleTime" type="datetime-local">
        </label>
    </div>
    <p></p>
    <div>
        <label>Status
            <input name="status">
        </label>
    </div>
    <p></p>
    <div>
        <label>Content
            <input name="content">
        </label>
    </div>
    <p></p>
    <button data-api-name="onlineTopupStatusNotify">Notify</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Top Up List(充值记录列表)</h3>
<div class="test-container">
    <div>
        <label>Top up type
            <input name="topUpType">
        </label>
    </div>
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <div>
        <label>
            Available types:</p>
            手动: 1,</p>
            在线: 2</p>
        </label>
    </div>
    <p>
        <button id="getLastTopupRecords" data-api-name="getTopupList">getLastTopupRecords</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>TEST Top Up HISTORY(充值历史)</h3>
<div class="test-container">
    <div>
        <label>Top up type
            <input name="topUpType">
        </label>
    </div>
    <div>
        <label>Status
            <input name="status">
        </label>
    </div>
    <div>
        <label>Start Time
            <input name="startTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>End Time
            <input name="endTime" type="datetime-local">
        </label>
        <p>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <div>
        <label>
            Available types:</p>
            手动: 1,</p>
            在线: 2</p>
        </label>
    </div>
    <p>
        <button id="getLastTopupRecords" data-api-name="getTopupHistory">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Province List (获取省份列表)</h3>
<div class="test-container">
    <div>
    </div>
    <p></p>
    <button data-api-name="getProvinceList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get City List (获取市列表)</h3>
<div class="test-container">
    <div>
        <label>Province Id
            <input name="provinceId">
        </label>
    </div>
    <p></p>
    <button data-api-name="getCityList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get District List (获取区县列表)</h3>
<div class="test-container">
    <div>
        <label>Province Id
            <input name="provinceId">
        </label>
    </div>
    <div>
        <label>City Id
            <input name="cityId">
        </label>
    </div>
    <p></p>
    <button data-api-name="getDistrictList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Bank Type List (获取银行卡类型列表)</h3>
<div class="test-container">
    <div>
    </div>
    <p></p>
    <button data-api-name="getBankTypeList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Check expired manual top up (手工订单超时后的再次确认请求)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="checkExpiredManualTopup">Check</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get valid first top up records 获取符合首冲条件的充值记录</h3>
<div class="test-container">
    <div>
        <label>Period 1:首冲 2:周首冲 3:月首冲
            <input name="period">
        </label>
    </div>
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <p>
        <button id="getValidFirstTopUpRecordList" data-api-name="getValidFirstTopUpRecordList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get valid top up return records 获取符合充值返点的充值记录</h3>
<div class="test-container">
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <p>
        <button id="getValidTopUpReturnRecordList" data-api-name="getValidTopUpReturnRecordList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get valid top up reward records 获取符合充值奖励的充值记录</h3>
<div class="test-container">
    <div>
        <label>Start Index
            <input name="startIndex" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>Request Count (max results)
            <input name="requestCount" type="number">
        </label>

        <p>
    </div>
    <div>
        <label>sort
            <input name="sort" type="number">
        </label>
        <p>
    </div>
    <p>
        <button id="getValidTopUpRewardRecordList" data-api-name="getValidTopUpRewardRecordList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Alipay top up (支付宝充值)</h3>
<div class="test-container">
    <div>
        <label>Amount
            <input name="amount">
        </label>
    </div>
    <div>
        <label>alipayName
            <input name="alipayName">
        </label>
    </div>
    <button data-api-name="requestAlipayTopup">Topup</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Cancel Alipay TopUp Request(取消支付宝充值)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="cancelAlipayTopup">Cancel</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get Alipay TopUp Request List(获取手工充值申请列表)</h3>
<div class="test-container">
    <button data-api-name="getAlipayTopupRequestList">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>wechat top up (微信充值)</h3>
<div class="test-container">
    <div>
        <label>Amount
            <input name="amount">
        </label>
    </div>
    <div>
        <label>name
            <input name="wechatName">
        </label>
    </div>
    <button data-api-name="requestWechatTopup">Topup</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Cancel wechat TopUp Request(取消微信充值)</h3>
<div class="test-container">
    <div>
        <label>Proposal Id
            <input name="proposalId">
        </label>
    </div>
    <p></p>
    <button data-api-name="cancelWechatTopup">Cancel</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Check Player Wechat Topup Available Status (微信充值状态)</h3>
<div class="test-container">
    <button data-api-name="getPlayerWechatPayStatus">Check</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Get alipay single limit (支付宝单笔限额)</h3>
<div class="test-container">
    <button data-api-name="getAlipaySingleLimit">Get</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<script>
    require(['services/client/ClientServices', 'common/WebSocketClient', 'common/TestHelper', 'testAPI/clientAPITest/ClientPaymentAPITest', 'testAPI/clientAPITest/ClientPlayerAPITest','testAPI/clientAPITest/ClientConnectionAPITest'],
            function (ClientServices, WebSocketClient, TestHelper, ClientPaymentAPITest, ClientPlayerAPITest, ClientConnectionAPITest) {
                var Client = function (url) {

                    WebSocketClient.call(this, url);

                    var paymentService = new ClientServices.PaymentService();
                    this.addService(paymentService);

                    var playerService = new ClientServices.PlayerService();
                    this.addService(playerService);

                    var conService = new ClientServices.ConnectionService();
                    this.addService(conService);
                };

                var proto = Client.prototype = Object.create(WebSocketClient.prototype);
                proto.constructor = Client;

                $(document).ready(function () {
                    var client = new Client(TestHelper.websocketURL);
                    client.connect();

                    client.addEventListener("open", function () {
                        var paymentService = client.getService("payment");
                        var clientPaymentAPITest = new ClientPaymentAPITest(paymentService);

                        var playerService = client.getService("player");
                        var clientPlayerAPITest = new ClientPlayerAPITest(playerService);

                        var connectionService = client.getService("connection");
                        var connAPITest = new ClientConnectionAPITest(connectionService);

                        connAPITest.setLang(function (data) {
                            console.log('setlang data.....', data);
                        });

                        TestHelper.loginCookiePlayer(client, ClientPlayerAPITest);

                        function _arrayBufferToBase64(buffer) {
                            var binary = '';
                            var bytes = new Uint8Array(buffer);
                            var len = bytes.byteLength;
                            for (var i = 0; i < len; i++) {
                                binary += String.fromCharCode(bytes[i]);
                            }
                            return window.btoa(binary);
                        }

                        $("#getPaymentCaptcha").click(function () {
                            clientPlayerAPITest.captcha(function (data) {
                                console.log("captchaCode", data);
                                $("#paymentCaptchaImg").attr("src", "data:image/png;base64," + _arrayBufferToBase64(data.data.data));
                            });
                        });

                        TestHelper.setAPIName('ClientPaymentAPITest.payment');
                        TestHelper.attachListeners(clientPaymentAPITest);

                    });

                    TestHelper.addReconnectOnCloseListener(client);
                });
            }
    );
</script>
</body>
</html>
