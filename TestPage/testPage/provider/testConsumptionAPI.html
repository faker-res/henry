<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>Test Player</title>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>-->
    <!--<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>-->
    <!--<script src="common/require.js" data-main="testPlayerAPI"></script>-->
</head>
<body>
<h3>Transfer in Credit (额度转入CP)</h3>
<div class="test-container">
    <div>
        <label>Player ID</label>
        <input name="playerId" type="text">
    </div>
    <div>
        <label>Provider ID</label>
        <input name="providerId" type="text">
    </div>
    <div>
        <label>Amount</label>
        <input name="amount" type="number">
    </div>
    <button data-api-name="transferIn">Transfer in Credit</button>
    <div>
        <textarea></textarea>
    </div>
</div>
<h3>Transfer out Credit (额度转出CP)</h3>
<div class="test-container">
    <div>
        <label>Player ID</label>
        <input name="playerId" type="text">
    </div>
    <div>
        <label>Provider ID</label>
        <input name="providerId" type="text">
    </div>
    <button data-api-name="transferOut">Transfer out Credit</button>
    <div>
        <textarea></textarea>
    </div>
</div>
<h3>Update Transfer Progress (更新转让进度)</h3>
<div class="test-container">
    <div>
        <label>Player ID</label>
        <input name="playerId" type="text">
    </div>
    <div>
        <label>Progress data(JSON)</label>
        <input name="progressData" type="text">
    </div>
    <button data-api-name="updateTransferProgress">Update</button>
    <div>
        <textarea></textarea>
    </div>
</div>
<h3>Add player consumption (添加玩家消费额度)</h3>
<div class="test-container">
    <div>
        <label>Player Name
            <input name="userName">
        </label>
    </div>
    <div>
        <label>Platform Id
            <input name="platformId">
        </label>
    </div>
    <div>
        <label>Provider Id
            <input name="providerId">
        </label>
    </div>
    <div>
        <label>Game Id
            <input name="gameId">
        </label>
    </div>
    <div>
        <label>Game Code
            <input name="code">
        </label>
    </div>
    <div>
        <label>Round No
            <input type='number' name="roundNo">
        </label>
    </div>
    <div>
        <label>Amount (credit change)
            <input name="amount" type="number">
        </label>
    </div>
    <div>
        <label>Valid Amount
            <input name="validAmount" type="number">
        </label>
    </div>
    <div>
        <label>Bonus Amount
            <input name="bonusAmount" type="number">
        </label>
    </div>
    <div>
        <label>Order No
            <input name="orderNo">
        </label>
    </div>
    <div>
        <label>Create Time
            <input name="createTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Order Time
            <input name="orderTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Settlement Time
            <input name="settlementTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>CP Game Type
            <input name="cpGameType">
        </label>
    </div>
    <div>
        <label>Bet Type
            <input name="betType">
        </label>
    </div>
    <div>
        <label>Content
            <input name="content">
        </label>
    </div>
    <div>
        <label>Result
            <input name="result">
        </label>
    </div>
    <div>
        <label>Play Detail
            <input name="playDetail">
        </label>
    </div>
    <div>
        <label>Bet Details
            <input type="number" id="separatedBetAmount" placeholder="separatedBetAmount"/>
            <input type="text" id="separatedBetType" placeholder="separatedBetType"/>
        </label>
        <button onclick="addBetDetails()">add bet</button>
        <button onclick="resetBetDetails()">reset bet</button>
        <input name="betDetails" id="betDetails" hidden>
    </div>
    <div>
        <ul id="betTypeList"/>
    </div>
    <message>(Blank entries only work if you first add a new game and a new provider.)</message>
    <p>
        <button data-api-name="addConsumption">Add Player Consumption</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Add missing consumption (添加玩家消费额度)</h3>
<div class="test-container">
    <div>
        <label>Player Name
            <input name="userName">
        </label>
    </div>
    <div>
        <label>Platform Id
            <input name="platformId">
        </label>
    </div>
    <div>
        <label>Provider Id
            <input name="providerId">
        </label>
    </div>
    <div>
        <label>Game Id
            <input name="gameId">
        </label>
    </div>
    <div>
        <label>Game Code
            <input name="code">
        </label>
    </div>
    <div>
        <label>Round No
            <input type='number' name="roundNo">
        </label>
    </div>
    <div>
        <label>Amount (credit change)
            <input name="amount" type="number">
        </label>
    </div>
    <div>
        <label>Valid Amount
            <input name="validAmount" type="number">
        </label>
    </div>
    <div>
        <label>Bonus Amount
            <input name="bonusAmount" type="number">
        </label>
    </div>
    <div>
        <label>Order No
            <input name="orderNo">
        </label>
    </div>
    <div>
        <label>Create Time
            <input name="createTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Order Time
            <input name="orderTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Settlement Time
            <input name="settlementTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Content
            <input name="content">
        </label>
    </div>
    <div>
        <label>Result
            <input name="result">
        </label>
    </div>
    <div>
        <label>Play Detail
            <input name="playDetail">
        </label>
    </div>
    <message>(Blank entries only work if you first add a new game and a new provider.)</message>
    <p>
        <button data-api-name="addMissingConsumption">Add Missing Consumption</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Add Consumption List (添加多条消费记录)</h3>
<div class="test-container">
    <div>
        <label>Consumption List</label>
        <input name="consumptionList" type="text">
    </div>
    <button data-api-name="addConsumptionList">Add</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Correct Consumption List (修改多条消费记录)</h3>
<div class="test-container">
    <div>
        <label>Consumption List</label>
        <input name="consumptionList" type="text">
    </div>
    <button data-api-name="correctConsumptionList">Correct</button>
    <div>
        <textarea></textarea>
    </div>
</div>

<h3>Update player consumption (更新玩家消费记录)</h3>
<div class="test-container">
    <div>
        <label>Player Name
            <input name="userName">
        </label>
    </div>
    <div>
        <label>Platform Id
            <input name="platformId">
        </label>
    </div>
    <div>
        <label>Provider Id
            <input name="providerId">
        </label>
    </div>
    <div>
        <label>Game Id
            <input name="gameId">
        </label>
    </div>
    <div>
        <label>Game Code
            <input name="code">
        </label>
    </div>
    <div>
        <label>Round No
            <input type='number' name="roundNo">
        </label>
    </div>
    <div>
        <label>Amount (credit change)
            <input name="amount" type="number">
        </label>
    </div>
    <div>
        <label>Valid Amount
            <input name="validAmount" type="number">
        </label>
    </div>
    <div>
        <label>Bonus Amount
            <input name="bonusAmount" type="number">
        </label>
    </div>
    <div>
        <label>Order No
            <input name="orderNo">
        </label>
    </div>
    <div>
        <label>Create Time
            <input name="createTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Order Time
            <input name="orderTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Settlement Time
            <input name="settlementTime" type="datetime-local">
        </label>
    </div>
    <div>
        <label>Content
            <input name="content">
        </label>
    </div>
    <div>
        <label>Result
            <input name="result">
        </label>
    </div>
    <div>
        <label>Play Detail
            <input name="playDetail">
        </label>
    </div>
    <message>(Blank entries only work if you first add a new game and a new provider.)</message>
    <p>
        <button data-api-name="updateConsumption">Update Player Consumption</button>
    <div>
        <textarea></textarea>
    </div>
</div>

</div>
<script>
    require(['services/provider/ProviderServices', 'common/WebSocketClient', 'common/TestHelper', 'testAPI/providerAPITest/ConsumptionAPITest', 'testAPI/providerAPITest/ConnectionAPITest'],
            function (ProviderServices, WebSocketClient, TestHelper, ConsumptionAPITest, connectionAPITest) {
                var Client = function (url) {

                    WebSocketClient.call(this, url);

                    var providerService = new ProviderServices.ConsumptionService();
                    this.addService(providerService);

                    var connectionService = new ProviderServices.ConnectionService();
                    this.addService(connectionService);
                };

                var proto = Client.prototype = Object.create(WebSocketClient.prototype);
                proto.constructor = Client;

                $(document).ready(function () {
                    var client = new Client("ws://" + TestHelper.websocketIP + ":9380");
                    client.connect();

                    client.addEventListener("open", function () {
                        var providerService = client.getService("consumption");
                        var consumptionAPITest = new ConsumptionAPITest(providerService);

                        var connectionService = client.getService("connection");
                        var connAPITest = new connectionAPITest(connectionService);
                        console.log("connectionService....",connectionService );

                        connAPITest.login(function (data) {
                            console.log('login data.....', data);
                        }, {
                            name: "testApiUser",
                            password: "123",
                            role: "API"
                        });

                        TestHelper.setAPIName('ProviderServices.consumption');
                        TestHelper.attachListeners(consumptionAPITest);

                    });

                    TestHelper.addReconnectOnCloseListener(client);
                });
            }
    );

    let list = [];
    let listHTML= ""
    function addBetDetails(){
        let betDetails = document.getElementById("betDetails");
        let separatedBetType = document.getElementById("separatedBetType");
        let separatedBetAmount = document.getElementById("separatedBetAmount");

        if (separatedBetType.value && separatedBetAmount.value) {
            list.push({'separatedBetType': separatedBetType.value, 'separatedBetAmount': separatedBetAmount.value});
        }

        if (list && list.length > 0) {
            betDetails.value = JSON.stringify(list);

            document.getElementById("betTypeList").innerHTML = "";
            for (let i = 0; i < list.length; i++)
            {
                listHTML = "<li>" + "separatedBetType: " + list[i].separatedBetType + ", " + "separatedBetAmount: " + list[i].separatedBetAmount + "</li>";
                document.getElementById("betTypeList").innerHTML += listHTML;
            }
        }

        document.getElementById("separatedBetType").innerHTML = "";
        document.getElementById("separatedBetAmount").innerHTML = "";
    }

    function resetBetDetails(){
        document.getElementById("betDetails").value = null;
        document.getElementById("separatedBetType").value = null;
        document.getElementById("separatedBetAmount").value = null;
        document.getElementById("betTypeList").innerHTML = "";
        list = [];
    }
</script>
</body>
</html>